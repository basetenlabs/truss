name: "model"
backend: "python"
max_batch_size: {{ max_batch_size }}

{% if dynamic_batching_delay_microseconds is defined %}
dynamic_batching { max_queue_delay_microseconds: {{dynamic_batching_delay_microseconds}} }
{% endif %}

input [
{% for inp in inputs %}
    {
        name: "{{ inp.name }}"
        data_type: {{ inp.type }}
        dims: [{{ inp.dims|join(', ') }}]
    }{% if not loop.last %},{% endif %}
{% endfor %}
]

output [
{% for out in outputs %}
    {
        name: "{{ out.name }}"
        data_type: {{ out.type }}
        dims: [{{ out.dims|join(', ') }}]
    }{% if not loop.last %},{% endif %}
{% endfor %}
]

instance_group [
  {
    kind: KIND_GPU
    count: {{ num_replicas }}
  }
]
